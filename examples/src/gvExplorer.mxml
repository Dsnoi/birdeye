<?xml version="1.0" encoding="utf-8"?>
<!--
 * The MIT License
 *
 * Copyright (c) 2008
 * United Nations Office at Geneva
 * Center for Advanced Visual Analytics
 * http://cava.unog.ch
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 -->
 
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
	xmlns:ui="ui.*"
	xmlns:flexlib="http://code.google.com/p/flexlib/" 
	xmlns:geomap="org.un.cava.birdeye.geo.views.maps.usa.*"
	xmlns:features="org.un.cava.birdeye.geo.features.*"
	xmlns:degrafa="com.degrafa.*"
    xmlns:paint="com.degrafa.paint.*" xmlns:geometry="com.degrafa.geometry.*"
	backgroundGradientColors="[#333333,#999999]" layout="vertical"
	width="100%" height="100%" applicationComplete="init()">

<mx:Script>
	<![CDATA[
		import mx.events.StateChangeEvent;
		import mx.events.FlexEvent;
		import mx.events.ChildExistenceChangedEvent;
		import mx.events.ListEvent;
		import mx.controls.Alert;
		
		import org.un.cava.birdeye.geo.views.maps.usa.*
		import org.un.cava.birdeye.geo.views.maps.world.*
		import org.un.cava.birdeye.geo.features.*
		
		[Bindable]
        public var arrProjWorld:Array = new Array("Geographic", "Mollweide", "WinkelTripel", "Miller cylindrical","EckertIV","EckertVI","Goode","Robinson","Sinsoidal","Lambert equal area" );
 		[Bindable]
        public var arrProjUSA:Array = new Array("Geographic");
 
 		private var myMap:Object;
		
		public function init():void{
						
		}
		
		private function layout_Selected(e:ListEvent):void{
			if(e.currentTarget.selectedLabel=="-- USA (States)"){
				projectionSelector.dataProvider=arrProjUSA;
			}else{
				projectionSelector.dataProvider=arrProjWorld;
			}
			projectionSelector.selectedIndex=-1;		
		}
		
		private function projection_Selected(e:ListEvent):void{
			progressBar.visible=true;
			mapCnvs.addEventListener(FlexEvent.UPDATE_COMPLETE, createNewMap);
			mapCnvs.removeChild(mapCnvs.getChildByName("map"));
			//createNewMap()
		}
		
		private function createNewMap(event:FlexEvent):void{
			
			if (layoutSelector.selectedLabel=="World"){
				myMap=new WorldMap();
			}else if (layoutSelector.selectedLabel=="Africa"){
				myMap=new AfricaMap();
			}else if (layoutSelector.selectedLabel=="-- USA (States)"){
				myMap=new USStates();
			}else if (layoutSelector.selectedLabel=="North America"){
				myMap=new NorthAmericaMap();
			}else if (layoutSelector.selectedLabel=="South America"){
				myMap=new SouthAmericaMap();
			}else if (layoutSelector.selectedLabel=="Asia"){
				myMap=new AsiaMap();
			}else if (layoutSelector.selectedLabel=="Oceania"){
				myMap=new OceaniaMap();
			}else if (layoutSelector.selectedLabel=="Europe"){
				myMap=new EuropeMap();
			}else if (layoutSelector.selectedLabel=="CIS"){
				myMap=new CISMap();
			}else if (layoutSelector.selectedLabel=="-- North"){
				myMap=new NorthAfricaMap();
			}else if (layoutSelector.selectedLabel=="-- Sub-Saharan"){
				myMap=new SubSaharaMap();
			}else if (layoutSelector.selectedLabel=="-- Eastern"){
				myMap=new EasternMap();
			}else if (layoutSelector.selectedLabel=="-- Southern"){
				myMap=new SouthernMap();
			}else if (layoutSelector.selectedLabel=="-- South-eastern"){
				myMap=new SouthEasternMap();
			}else if (layoutSelector.selectedLabel=="-- Western"){
				myMap=new WesternMap();
			}
			myMap.name="map";
			myMap.projection=projectionSelector.selectedLabel;
			myMap.x="10"; 
			myMap.y="10"; 
			myMap.scaleX=zoomer.value; 
			myMap.scaleY=zoomer.value; 
			mapCnvs.removeEventListener(FlexEvent.UPDATE_COMPLETE, createNewMap);
			progressBar.visible=false;
			mapCnvs.addChild((myMap as Canvas));
		}
		
		private function changeSize():void{
		 (myMap as Canvas).scaleX=zoomer.value;
		 (myMap as Canvas).scaleY=zoomer.value;
	  	}

	]]>
</mx:Script>
<mx:Style source="styles/main.css" />
	
<!-- Effects -->
	<mx:WipeLeft id="wipeLeft" duration="1000" />
	<mx:WipeRight id="wipeRight" duration="1000" />
	
	<mx:VBox width="100%" height="100%" verticalGap="10" >
	<mx:ApplicationControlBar width="100%" height="45" >
		<mx:VBox width="100%" paddingLeft="5" paddingRight="5" >
			<mx:Label text="GeoVis Explorer" fontWeight="bold" color="#FFFFFF" fontSize="16" />
		</mx:VBox>
	</mx:ApplicationControlBar>	
	
	<mx:HBox id="DivNavRB" width="100%" height="100%" paddingBottom="5" horizontalGap="5">
		<mx:HBox id="sideBar" width="300" height="100%" horizontalGap="0" >
			<ui:Grip id="navGrip" 
				width="17" height="100%" horizontalAlign="center"
				gripTip="Show/Hide Control Panel" />
			<mx:VBox id="NavContainerRB" horizontalScrollPolicy="off" verticalScrollPolicy="off" verticalAlign="middle" horizontalAlign="center" verticalGap="1" horizontalGap="0" width="100%" height="100%" hideEffect="{wipeLeft}" showEffect="{wipeRight}">
				<mx:Accordion id="leftAccordion" paddingBottom="5" paddingRight="5" paddingTop="5" paddingLeft="5" width="100%" height="100%" creationPolicy="all" >
					<mx:Canvas id="visibilitycnvs" label="Controls" height="100%" width="100%" paddingBottom="5" >
						<mx:VBox width="100%" horizontalAlign="center">
							<mx:Spacer height="3" />
								
							<!-- Controls -->
							<flexlib:WindowShade id="controlsCnvs" styleName="linkButtonWindowShade" 
      							label="Zoom" width="100%" opened="false" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:ComboBox id="zoomSelector" prompt="Select zoom focus..." width="95%" toolTip="Some layouts are under construction" >
									<mx:ArrayCollection>
										<mx:String>World</mx:String>
										<mx:String>---Regions---</mx:String>
										<mx:String>Africa</mx:String>
										<mx:String>SingleCycleCircle</mx:String>
									</mx:ArrayCollection>
								</mx:ComboBox>
								<mx:HBox width="100%" >
								<mx:Label text="Scale:" />
								<mx:HSlider id="zoomer" value="0.9" minimum="0.8" maximum="2" change="changeSize()" allowTrackClick="true"  />
								</mx:HBox>
								<mx:HBox width="100%" >
								<mx:Label text="Nearest Neighbor" />
								<mx:HSlider  />
								</mx:HBox>
							</mx:VBox>
							</flexlib:WindowShade>
								
							<!-- Map and Layout Parameters -->
							<flexlib:WindowShade id="layoutCnvs" styleName="linkButtonWindowShade" 
      							label="Layout" width="100%" opened="true" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<!--<mx:HBox width="100%" >
								<mx:Label text="Base Map:" />
								<mx:RadioButtonGroup id="baseMap" labelPlacement="right" />
									<mx:RadioButton groupName="baseMap" id="worldRB" value="World" 
            							label="World" />
        							<mx:RadioButton groupName="baseMap" id="usaRB" value="USA" 
            							label="USA" selected="true" />
        					</mx:HBox>-->
							<mx:ComboBox id="layoutSelector" prompt="Select map..." width="95%" toolTip="Some layouts are under construction" change="layout_Selected(event)" >
								<mx:ArrayCollection>
							         <mx:Object label="World" data="World" />
							         <mx:Object label="Africa" data="Africa" />
							         <mx:Object label="-- North" data="North" />
							         <mx:Object label="-- Sub-Saharan" data="Sub-Sahara" />
							         <mx:Object label="Asia" data="Asia" />
							         <mx:Object label="-- Eastern" data="Eastern" />
							         <mx:Object label="-- Southern" data="Southern" />
							         <mx:Object label="-- South-eastern" data="South-eastern" />
							         <mx:Object label="-- Western" data="Western" />
							         <mx:Object label="CIS" data="CIS" />
							         <mx:Object label="Europe" data="Europe" />
							         <mx:Object label="North America" data="NorthAmerica" />
							         <mx:Object label="-- USA (States)" data="USStates" />
							         <mx:Object label="Oceania" data="Oceania" />
							         <mx:Object label="South America" data="SouthAmerica" />
							     </mx:ArrayCollection>
							</mx:ComboBox>
							<mx:ComboBox id="projectionSelector" prompt="Select projection..." width="95%" toolTip="Set projection" change="projection_Selected(event)" >
								<mx:Array>
                						<!--<mx:Object label="Geographic" />
                						<mx:Object label="AlbertsEqualArea" />
                						<mx:Object label="Mollweide" />
                						<mx:Object label="WinkelTripel" />
                						<mx:Object label="MillerCylindrical" />
                						<mx:Object label="EckertIV" />
                						<mx:Object label="EckertVI" />
                						<mx:Object label="Goode" />
                						<mx:Object label="LambertEqualArea" />
                						<mx:Object label="Robinson" />
                						<mx:Object label="Sinsoidal" />-->
            					</mx:Array>
								
							</mx:ComboBox>	
				
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- Features Styles -->
							<flexlib:WindowShade id="featuresCnvs" styleName="linkButtonWindowShade" 
      							label="Features" width="100%" opened="true" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:ComboBox id="featureSelector" height="20" width="95%" prompt="Color by..." toolTip="Select the orientation of tree layout" >
									<mx:ArrayCollection>
										<mx:String>X</mx:String>
										<mx:String>Y</mx:String>
										<mx:String>Z</mx:String>
									</mx:ArrayCollection>
							</mx:ComboBox>	
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- Symbols Styles -->
							<flexlib:WindowShade id="symbolsCnvs" styleName="linkButtonWindowShade" 
      							label="Symbols" width="100%" opened="true" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:ComboBox id="symbolSelector" height="20" width="95%" prompt="Add Symbols..." toolTip="Select the orientation of tree layout" >
									<mx:ArrayCollection>
										<mx:String>Bubble</mx:String>
										<mx:String>Chart</mx:String>
										<mx:String>Flow</mx:String>
										<mx:String>Glyph</mx:String>
									</mx:ArrayCollection>
							</mx:ComboBox>	
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- Surrounds Styles -->
							<flexlib:WindowShade id="surroundsCnvs" styleName="linkButtonWindowShade" 
      							label="Surrounds" width="100%" opened="true" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="left" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:CheckBox label="Show Legend" />
							<mx:CheckBox label="Show Grid" />
							<mx:CheckBox label="Show Scale" />
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- View Controls -->
							<flexlib:WindowShade id="viewCnvs" styleName="linkButtonWindowShade" 
      							label="View" width="100%" opened="true" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							
							<mx:HBox width="100%" >
								<mx:Label text="Perspective" />
								<mx:RadioButtonGroup id="perspective" labelPlacement="right" />
									<mx:RadioButton groupName="perspective" id="twod" value="twod" 
            							label="2D" selected="true" />
        							<mx:RadioButton groupName="perspective" id="plane" value="plane" 
            							label="3D Plane" />
        							<mx:RadioButton groupName="perspective" id="sphere" value="sphere" 
            							label="3D Sphere" />
							</mx:HBox>
							<mx:HBox width="100%" >
								<mx:Label text="Pan" />
								<mx:HSlider  />
							</mx:HBox>
							<mx:HBox width="100%" >
								<mx:Label text="Tilt" />
								<mx:HSlider  />
							</mx:HBox>
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- Style Controls -->
							<flexlib:WindowShade id="styleCnvs" styleName="linkButtonWindowShade" 
      							label="Style" width="100%" opened="false" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:ComboBox id="styleSelector" height="20" width="95%" prompt="Select style..." toolTip="Select the orientation of tree layout" >
									<mx:ArrayCollection>
										<mx:String>White Background</mx:String>
										<mx:String>Black Background</mx:String>
										<mx:String>Custom</mx:String>
									</mx:ArrayCollection>
							</mx:ComboBox>
							<mx:HBox horizontalAlign="left" >
							<mx:Label text="Stroke:" />
							<mx:ColorPicker />	
							<mx:Label text="Background:" />
							<mx:ColorPicker />
							</mx:HBox>
							</mx:VBox>
							</flexlib:WindowShade>
							
							<!-- Events and Effects -->
							<flexlib:WindowShade id="eventsCnvs" styleName="linkButtonWindowShade" 
      							label="Events and Effects" width="100%" opened="false" horizontalAlign="center" paddingBottom="5" >
							<mx:VBox width="97%" horizontalAlign="center" paddingLeft="5" paddingRight="5" paddingBottom="5" paddingTop="5" borderColor="#666666" borderThickness="1" cornerRadius="5" borderStyle="solid" backgroundColor="#FFFFFF" backgroundAlpha=".8" >
							<mx:ComboBox id="eventSelector" height="20" width="95%" prompt="Select event..." toolTip="Select the orientation of tree layout" >
									<mx:ArrayCollection>
										<mx:String>RollOver/Rollout</mx:String>
										<mx:String>itemClick</mx:String>
										<mx:String>Custom</mx:String>
									</mx:ArrayCollection>
							</mx:ComboBox>
							<mx:HBox horizontalAlign="left" >
							<mx:Label text="Stroke:" />
							<mx:ColorPicker />	
							<mx:Label text="Background:" />
							<mx:ColorPicker />
							</mx:HBox>
							</mx:VBox>
							</flexlib:WindowShade>
							
							<mx:Spacer height="100%" />
							
							
							
						</mx:VBox>		
					</mx:Canvas>
					<mx:Canvas id="searchcnvs" label="Search/Filter Nodes" height="100%" width="100%">
						<mx:VBox width="100%" height="100%" paddingLeft="5" paddingRight="5">
						</mx:VBox>
					</mx:Canvas>
					
									
				</mx:Accordion>
				
			</mx:VBox>		
		</mx:HBox>

		<!-- Map Panel -->
		<mx:Canvas id="mapCnvs" borderStyle="solid" borderColor="#CCCCCC" backgroundColor="#FFFFFF" width="100%" height="100%" verticalScrollPolicy="off">		
			<mx:ProgressBar id="progressBar" indeterminate="true" visible="false"/>
			<geomap:USStates id="map" name="map" projection="Geographic" x="10" y="10" scaleX="{zoomer.value}" scaleY="{zoomer.value}" >
				<features:Features foid="CT" fillItem="0x6699FF" alpha="0.6" toolTip="Connecticut" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
				<features:Features foid="AK" fillItem="0xCCCCFF" alpha="0.6" toolTip="Alaska" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
				<features:Features foid="TX" fillItem="0x3366CC" alpha="0.6" toolTip="Texas" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
				<features:Features foid="CA" fillItem="0x003399" alpha="0.6" toolTip="California" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
				<features:Features foid="VA" fillItem="0x336699" alpha="0.6" toolTip="Virginia" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
				<features:Features foid="MN" fillItem="0x9999FF" alpha="0.6" toolTip="Minnesota" scaleX="{zoomer.value}" scaleY="{zoomer.value}" />
			</geomap:USStates>
			<!-- Window shade -->
			<mx:VBox width="100%" height="150" left="5" right="5" bottom="5" 
        	verticalAlign="top" horizontalAlign="center" horizontalScrollPolicy="off" verticalScrollPolicy="off">
        	<mx:HBox width="100%" height="100%" paddingTop="5" paddingLeft="5" paddingRight="5" paddingBottom="5" 
        		cornerRadius="12" borderStyle="solid" borderThickness="2" borderColor="#CCCCCC" backgroundColor="#CCCCCC" backgroundAlpha="0.3"
        		>
            	
			</mx:HBox>
        	</mx:VBox>
			
		</mx:Canvas>
		<!-- End of Graph Panel -->
	</mx:HBox>
</mx:VBox>
		
	<mx:states>
       <mx:State name="showCntrlPanel">
			<mx:SetProperty target="{sideBar}" name="width" value="300" />
			<mx:SetStyle target="{DivNavRB}" name="horizontalGap" value="5" />
       </mx:State>        
		<mx:State name="hideCntrlPanel">
			<mx:SetProperty target="{sideBar}" name="width" value="17" />
			<mx:SetStyle target="{DivNavRB}" name="horizontalGap" value="0" />
		</mx:State>
	</mx:states>
	<mx:transitions>
		<mx:Transition fromState="*" toState="*">
			<mx:Resize target="{sideBar}" />
		</mx:Transition>
	</mx:transitions>


	
</mx:Application>